---
title: "计算机网络基础 — 计算机网络和因特网"
subtitle: "网络中的网络！"
layout: post
author: "luobr"
header-style: text
tags:
  - 计算机网络基础
  - 因特网
  - 网络核心和边缘
  - 笔记
---

## 计算机网络和因特网

### 什么是 Internet?

网络中的网络

#### 具体构造的的角度

- **节点**

  - 主机及其上运行的应用程序
  - 路由器、交换机等网络交换设备

- **边**：通信链路（光纤、同轴电缆以及无线电等等）

  - 接入网链路：与主机直接互通的互联网的链路
  - 主干链路：网路交换设备间的链路

- **协议**：规定语法、语义、时序以及动作

  定义了两个或多个通信实体之间交换的报文格式和次序，以及在报文传输、接收或其他事件方面所采取的动作

#### 服务角度

互联是分布式的应用进程以及为分布式应用进程提供通信服务的基础设施

- 使用通信设施进行通信的分布式应用（Web、电子商务、社交网络等等）
- 通信基础设施为 APP 提供通信服务（无连接不可靠服务、面向连接的可靠服务）

#### 网络结构

- **网络边缘**
  - 主机
  - 应用进程（客户端和服务器）
- **网络核心**
  - 互联着的路由器
  - 网络的网络
- **接入网、物理媒体**
  - 有线或者没线通信链路

### 网络边缘

**组成**：端系统（主机）：运行应用进程（Web、email）

- 客户端/服务器模式（服务器是主，客服端是从）

  客户端向服务器请求、接收服务（Web浏览器/服务器）

- 对等模式（p2p）

  端点既是客服端也是服务器（去中心化的分布式服务）

**采用网络设施的面向连接服务**

目标：在端系统之间传输数据

**TCP 服务**

HTTP、FTP、Telnet、SMTP

- 可靠地、按顺序地传送数据（确认和重传）
- 流量控制（发送方不会淹没接收方）
- 拥塞控制（当网络拥塞时候，发送方降级发送速率）

**UDP 服务**

流媒体、远程会议以及DNS等等

- 无连接
- 无可靠数据传输
- 无流量控制
- 无拥塞控制

---

### 网络核心

路由器的网状结构

**网络的核心的关键功能**

- 路由：决定分组采用的源到目标的路径（路由算法）
- 转发：将分组从路由器的输入链路转移到输出链路上

#### 电路交换

为每个呼叫预留一条专有电路，如电话网

<img src="https://use-typora.oss-cn-hangzhou.aliyuncs.com/image-20240323102159697.png" alt="image-20240323102159697" style="zoom:67%;" />  

端到端的资源被分配给从源端到目标端的呼叫（通常被传统电话网络采用）

**独享资源**（不同享）：每个呼叫一旦建立起来就能够保证性能，如果呼叫没有数据发送，被分配的资源就会被浪费

**网络资源**（如带宽）被分成片

- **频分多路复用**（有线电视网络、无线广播等）
  - 原理：FDM 将整个传输频带分割成多个独立的子频带，每个子频带分配给一个信号传输使用
  - 特点：各个信号在整个传输过程中占用固定的频带，互不干扰

- **时分多路复用**（电话网络、数字传输系统等）
  - 原理：TDM 将时间分割成一系列的时隙，每个信号在分配给它的时间时隙中传输
  - 特点：所有信号共享相同的频带宽度，但在不同的时间传输
- **波分多路复用**（长途光纤通信、数据中心内部网络等）
  - 原理：WDM类似于频分多路复用，但在光纤通信中，它使用不同的波长（频率）来区分不同的信号
  - 特点：每个信号分配一个独特的波长，可以在同一条光纤上同时传输

**电路交换不适合计算机之间的通信**

- 建立的连接的时间长
- 计算机之间的通信有突发性，如果使用线路交换，则浪费的片较多（独享）

#### 分组交换

##### 概述

<img src="https://use-typora.oss-cn-hangzhou.aliyuncs.com/image-20240525123642280.png" alt="image-20240525123642280" style="zoom:67%;" />  

以分组为单位存储-转发方式

- 被传输到下一个链路之前，整个分组必须达到到达路由器/链路层交换机：存储-转发
- 在一个速率为 R bps 的链路上，一个长度为 L bit 的分组的存储转发延时为 L/R s

##### 排队时延和分组丢失

- 如果到达的分组需要传输到某条链路，但发现该链路正忙于传输其他分组，该到达分组必须在输出缓存中等待。因此，除了存储转发时延以外，分组还要承受输出缓存的排队时延
- 如果路由器的缓存用完了，分组将会抛弃，这就是分组丢失

##### 转发表和路由选择协议

- **转发表**：用于记录目的地址（或目的地址的一部分）映射输出链路地址的表
- **路由选择协议**：用于自动地设置这些转发表。例如，一个路由选择协议可以决定从每台路由器到每个目的地的最短路径，并使用这些最短路径结果来配置路由器中的转发表

##### 按照有无网络层的连接

**数据报网络** (类似：问路 )

- 分组的目标地址决定下一跳 
- 在不同的阶段，路由可以改变 
- Internent

**虚电路网络** 

- 每个分组都带标签（虚电路标识 VCID），标签决定下一跳 
- 在呼叫建立时决定路径，在整个呼叫中路径保持不变 
- 路由器维持每个呼叫的状态信息

#### 分组交换 VS 电路交换

- 分组交换允许更多的用户，适用于突发式传输，但是会排队延迟以及会出现丢包现象
- 分组交换按需分配链路使用。链路传输能力将在所有需要在链路上传输分组的用户之间逐分组地被共享

----

### 接入网

**怎样将端系统和边缘路由器连接？**

- 住宅接入网络
- 单位接入网络 （学校、公司）
- 无线接入网络

#### DSL 因特网接入

DSL 数字用户线，住户通常从提供**本地电话**接入的本地电话公司处获得DSL因特网接入

- 高速下行信道，位于50kHz到1MHz频段
- 中速上行信道，位于4kHz到50kHz频段
- 普通的双向电话信道，位于0到4kHz频段

当使用DSL时，用户的本地电话公司也是它的 ISP。每个用户的 DSL调制解调器使用现有的电话线（即双绞铜线）与位于电话公司的本地中心局(CO)中的数字用户线接入复用器(DSLAM)交换数据

<img src="https://use-typora.oss-cn-hangzhou.aliyuncs.com/image-20240518201827152.png" alt="image-20240518201827152" style="zoom:80%;" /> 

#### 电缆因特网接入

利用了有线电视公司现有的有线电视基础设施。住宅从提供有线电视的公司获得了电缆因特网接入

**电缆调制解调器**通常是一个外部设备，通过一个以太网端口连接到家庭PC在电缆头端，**电缆调制解调器端接系统(Cable Modem Termination System,CMTS)**与DSL网络的DSLAM具有类似的功能，即将来自许多下行家庭中的电缆调制解调器发送的模拟信号转换回数字形式

<img src="https://use-typora.oss-cn-hangzhou.aliyuncs.com/image-20240518215926988.png" alt="image-20240518215926988" style="zoom:67%;" /> 

**注意**：与DSL不同，DSL每个用户一个专用线路到CO，电缆因特网接入的各用户共享到线缆头端的接入网络

#### 光纤到户 FTTH

一种提供更高速率的新兴技术是光纤到户(Fiber To The Home,TTH)。顾名思义FTTH概念简单，从本地中心局直接到家庭提供了一条光纤路径

<img src="https://use-typora.oss-cn-hangzhou.aliyuncs.com/image-20240518221050512.png" alt="image-20240518221050512" style="zoom:67%;" /> 

#### 无线接入网络

在无线LAN环境中，无线用户从/到一个接入点发送/接收分组，该接入点与企业网连接（很可能使用了有线以太网），企业网再与有线因特网相连。一个无线LAN用户通常必须位于接入点的几十米范围内

<img src="https://use-typora.oss-cn-hangzhou.aliyuncs.com/image-20240518225002925.png" alt="image-20240518225002925" style="zoom:67%;" /> 

----

### 物理媒体

物理媒体分成两种类型：导引型媒体和非导引型媒体

#### 导引型媒体

信号沿着固体媒介被导引：同轴电缆、光纤、双绞线

**双绞线**

两根绝缘铜导线拧合

<img src="https://use-typora.oss-cn-hangzhou.aliyuncs.com/image-20240519151535897.png" alt="image-20240519151535897" style="zoom: 33%;" /> 

**同轴电缆** 

两根同轴的铜导线，双向

- 基带电缆： 电缆上一个单个信道 ；Ethernet
- 宽带电缆： 电缆上有多个信道  ； HFC

![image-20240518230104834](https://use-typora.oss-cn-hangzhou.aliyuncs.com/image-20240518230104834.png) 

**光纤和光缆：**

光脉冲，每个脉冲表示一个 bit，在玻璃纤维中传输

- 高速，点到点的高速传输（如10 Gps-100Gbps传输速率 ）
- 低误码率，在两个中继器之间可以有很长的距离，不受电磁噪声的干扰
- 安全

#### 非导引性媒体

开放的空间传输电磁波或者光信号，在电磁或者光信号中承载数字数据

开放空间传输电磁波，携带要传输的数据

- 无需物理“线缆”
- 双向
- 传播环境效应：反射、吸收 、干扰

**无线链路类型**

**地面微波** 

- e.g. up to 45 Mbps channels

**LAN (e.g., WiFi)** 

- 11Mbps, 54 Mbps,540Mbps…

**wide-area**

- 4G 10Mbps 
- 5G 数Gbps

**卫星**

- 每个信道Kbps 到45Mbps (或者多个聚集信道) 
- 270 msec端到端延迟 
- 同步静止卫星和低轨卫星

----

### Internet 结构和 ISP

- **ISP**（因特网服务提供者）：是个向广大用户综合提供提供互联网接入业务，信息业务和增值业务的公司
- **ICP**（内容提供商）：自己部署专用网络，同时和各级 ISP 连接
- **IXP**：多个对等 ISP 互联互通之处，通常不涉及费用结算（对等接入）
- **POP**：高层 ISP 面向客户网络的接入点，涉及费用结算（多宿：一个底层 ISP 接入 多个高层 ISP）

<img src="https://use-typora.oss-cn-hangzhou.aliyuncs.com/image-20240526155909917.png" alt="image-20240526155909917" style="zoom:80%;" /> 

----

### 分组延时、丢失和吞吐量 

**为何会出现分组延时和丢失？**

在路由器缓冲区的分组队列

- 延时：分组等待排到队头、被传输
- 丢失：分组到达时，如果没有可用的缓冲区，则该分组被丢掉（分组到达链路的速率超过了链路输出的能力）

**节点总时延(total nodal delay)**：节点处理时延(nodal processing delay)、排队时延(queuing delay)、传输时延(transmission delay)和传播时延(propagation delay)

![image-20240728170426990](https://use-typora.oss-cn-hangzhou.aliyuncs.com/image-20240728170426990.png) 

#### 四种分组延时

1. 节点处理延时：检查 bit 级差错 ；检查分组首部和决定将分组导向何处

2. 排队延时：在输出链路上等待传输的时间 ； 依赖于路由器的拥塞程度

   流量强度 = La / R (越接近 0，平均排队延时越小；反之越接近 1，平均排队延时趋向于无限大，因此，流量工程中的一条金

   科玉律是：设计系统时流量强度不能大于  1)

   <img src="https://use-typora.oss-cn-hangzhou.aliyuncs.com/image-20240728172617128.png" alt="image-20240728172617128" style="zoom:50%;" />   

   - R 链路带宽(bps)
   - L 分组长度(bits)
   - a 分组到达队列的平均速率

3. 传输延时：将分组发送到链路上的时间： L / R （R：链路带宽(bps) ； L：分组长度(bits)） ；存储转发延时

4. 传播延时：传播延时 d / s （d：物理链路的长度 ； s：在媒体上的传播速度）

#### 分组丢失

- 链路的队列缓冲区容量有限
- 当分组到达一个满的队列时，该分组将会丢失
- 丢失的分组可能会被前一个节点或源端系统重传，或根本不重传

#### 吞吐量

吞吐量，在源端和目标端之间传输的速率（数据量/单位时间)

- 瞬间吞吐量：在一个时间点的速率
- 平均吞吐量：在一个长时间内平均值

瓶颈链路：端到端路径上，限制端到端吞吐的链路（水桶效应）

端到端平均吞吐 = min{R1，R2,…,Rn }

<img src="https://use-typora.oss-cn-hangzhou.aliyuncs.com/image-20240728195632530.png" alt="image-20240728195632530" style="zoom:67%;" />   

----

### 协议层次及其服务模型

![20240803163157](https://use-typora.oss-cn-hangzhou.aliyuncs.com/oss-cn-hangzhou20240803163157.png)

#### 概念

**服务**：低层实体向上层实体提供他们之间的通信能力

- 服务用户
- 服务提供者

**服务访问点 SAP**：使用下层提供的服务通过层间的接口（类似于上层调用下层的服务函数）

- socket，TCP 向应用层提供得服务访问点（用于区分上层应用）

**原语**：下层提供给上层服务的形式（类似于服务函数参数）

**服务类型**：面向连接的服务以及无连接

例如：TCP 向它的应用程序提供了面向连接的服务， 这种服务确保应用层报文向目的地传递的正确性和流量控制 ；UDP 协议向它的应用程序提供无连接服务。这是一种不提供不必要服务的服务，没有可靠性，没有流量控制，也没有拥塞控制  

**服务与协议的区别**

- 服务(Service)：低层实体向上层实体提供它们之间的通信的能力，是通过原语来操作的，垂直方向
- 协议(protocol)：对等层实体(peer entity)之间在相互通信的过程中，需要遵循的规则的集合，水平方向

**分层处理和实现复杂系统的好处？**

对付复杂的系统

- 概念化：结构清晰，便于标示网络组件，以及描述其相互关系（分层参考模型）
- 结构化：模块化更易于维护和系统升级 （改变某一层服务的实现不影响系统中的其他层次 ）
  -  对于其他层次而言是透明的 

#### 数据单元（DU）

PDU，协议数据单元：上层传输下来的数据 SDU，拼接上本层的 Header的数据则为本层的 PDU（通俗地讲就是封装上层的数据之后的称呼）

![image-20240731130956005](https://use-typora.oss-cn-hangzhou.aliyuncs.com/image-20240731130956005.png)  

SDU 与 PDU 存在关系：多对一（粘包）、一对一、一对多（拆包）的关系

####  协议栈

##### TCP/IP 协议 

- 应用层：网络应用

  - 为人类用户或者其他应用进程提供网络应用服务
  - FTP、SMTP、HTTP、DNS

- 传输层：主机之间的数据传输

  - 在网络层提供的端到端通信基础上，细分为进程到进程，将不可靠的通信变成可靠地通信

  - TCP、UDP

- 网络层：为数据报从源到目的选择路由

  - 主机主机之间的通信，端到端通信，不可靠

  - IP、路由协议

- 链路层：相邻网络节点间的数据传输

  - 2个相邻2点的通信，点到点通信，可靠或不可靠

  - 点对对协议PPP、802.11(wifi)、Ethernet

- 物理层：在线路上传送 bit

![20240803161139](https://use-typora.oss-cn-hangzhou.aliyuncs.com/oss-cn-hangzhou20240803161139.png) 

##### 各层次的协议数据单元

- 应用层：报文（message）
- 传输层：报文段（segment）TCP段，UDP数据报
- 网络层：分组（packet）（如果无连接方式：数据报 datagram）
- 数据链路层：帧（frame）
- 物理层：位（bit）

##### IOS/OSI 参考模型

- 表示层：允许应用解释传输的数据，e.g.、加密、压缩以及机器相关的表示转换
- 会话层：数据交换的同步，检查点，恢复

![20240803161241](https://use-typora.oss-cn-hangzhou.aliyuncs.com/oss-cn-hangzhou20240803161241.png) 


### 计算机网络和因特网的历史

#### 早期计算机网路（1960年以前）

主要使用的是线路交换网络，但是由于线路建立时间过长、独享方式占用通信资源以及可靠性不高等原因，寻求新型的网络模式，便出现分组交换网络

####  分组交换的发展（1961-1972）

网络控制协议是第一个端系统直接的主机-主机协议（NCP协议：相当于传输层和网络层在一起，支持应用开发）

####  专用网络和网络互联 （1972-1980）

定义了今天的Internet体系结构

#### 网络的激增（1980-1990）

1983: TCP/IP部署

- NCP分化成2个层次，TCP/IP，从而出现 UDP
- 覆盖式IP解决网络互联问题
- 主机设备和网络交换设备分开

####  因特网爆炸 （1990, 2000’s）

- TCP/IP体系结构的包容性，在其上部署应用便捷，出现非常多的应用
- 新一代杀手级应用（即时讯息，P2P 文件共享，社交网络等）更进一步促进互联网的发展
- 安全问题不断出现和修订（互联网的补丁对策）

#### 最新发展（2005 - 现在）

高速无线接入无处不在：移动互联时代 

- 4G部署,5G蓄势待发
- 带宽大，终端性能高，价格便宜，应用不断增多
